-- PSQL -D SRRF

DROP TABLE CLIENT_PRODUCT;
DROP TABLE PRODUCT_PICTURE;
DROP TABLE CATEGORIE;
DROP TABLE CLIENT_PICTURE;
DROP TABLE CLIENT;
DROP TABLE OPERATOR_CONTROLLER;
DROP TABLE CONTROLLER;
DROP TABLE PRODUCT;
DROP TABLE OPERATOR;

CREATE TABLE IF NOT EXISTS OPERATOR (
	PK_OPERATOR SERIAL,
	NAME TEXT,
	TELEFONE TEXT,
	CPF TEXT,
	EMAIL TEXT,
	LOGIN TEXT,
	PASSWORD TEXT,
	PASS_HASH TEXT,
	INACTIVE NUMERIC(9,2),
	PRIMARY KEY(PK_OPERATOR )
);

CREATE TABLE IF NOT EXISTS CONTROLLER (
	PK_CONTROLLER SERIAL,
	CONTROLLER TEXT,
	\"DEFAULT\" TEXT,
	PRIMARY KEY(PK_CONTROLLER )
);

CREATE TABLE IF NOT EXISTS OPERATOR_CONTROLLER(
    PK_OPERATOR INTEGER,
    PK_CONTROLLER INTEGER,
    FOREIGN KEY (PK_OPERATOR) REFERENCES OPERATOR(PK_OPERATOR),
    FOREIGN KEY (PK_CONTROLLER) REFERENCES CONTROLLER(PK_CONTROLLER)
);
CREATE TABLE IF NOT EXISTS CLIENT(
	PK_CLIENT SERIAL,
	NAME TEXT,
	EMAIL TEXT,
	TELEFONE TEXT,
	CPF TEXT,
	PRIMARY KEY(PK_CLIENT)
);
CREATE TABLE IF NOT EXISTS CLIENT_PICTURE(
	PK_CLIENT_PICTURE SERIAL,
	PK_CLIENT INTEGER,
	PICTURE TEXT,
    PRIMARY KEY (PK_CLIENT_PICTURE),
    FOREIGN KEY (PK_CLIENT) REFERENCES CLIENT(PK_CLIENT)
);

CREATE TABLE IF NOT EXISTS CATEGORIE(
    PK_CATEGORIE SERIAL,
    CATEGORIE TEXT,
    \"DEFAULT\" INTEGER,
    PRIMARY KEY(PK_CATEGORIE)
);

CREATE TABLE IF NOT EXISTS PRODUCT(
    PK_PRODUCT SERIAL,
    PRODUCT TEXT,
    DESCRIPTION TEXT,
    INACTIVE INTEGER,
    PRIMARY KEY(PK_PRODUCT)
);
CREATE TABLE IF NOT EXISTS PRODUCT_PICTURE(
    PK_PRODUCT_PICTURE SERIAL,
    PK_PRODUCT INTEGER,
    PICTURE TEXT,
    PRIMARY KEY (PK_PRODUCT_PICTURE),
    FOREIGN KEY (PK_PRODUCT) REFERENCES PRODUCT(PK_PRODUCT)
);

CREATE TABLE IF NOT EXISTS CLIENT_PRODUCT(
    PK_CLIENT_PRODUCT SERIAL,
    PK_CLIENT INTEGER,
    PK_PRODUCT INTEGER,
    PRIMARY KEY (PK_CLIENT_PRODUCT),
    FOREIGN KEY(PK_CLIENT) REFERENCES CLIENT(PK_CLIENT),
    FOREIGN KEY(PK_PRODUCT) REFERENCES PRODUCT(PK_PRODUCT)
);